## Project 5: Track and Field Tool

The goal of this project is to collect and explore high school track and field data using Python. Packages used with this project include: pandas, numpy, scipy, selenium, SQLite3, plotly, as well as datetime, time, re, and csv. While discussing the project with the stakeholder, they were curious about the correlations between events. As in, does a fast mark in the 100 meter influence how well the athlete will pole vault? They asked to view these correlations from a macro level then drill down to see rough comparisons between states within their recruiting sphere. The initial reports can be found in section 4 of Analysis within this project.  

### **Database: Design and Creation**

1. When initially testing the viability of this tool, I wrote the data to a list and stored that list as a .csv file to review. This worked at a small scale to prove the concept, but it would not scale well.
2. To provide room for growth, I designed and created a SQLite3 database. Using a consistent table structure of 'id' as a primary key and avoiding redundant strings, the database took shape.
3. The most up to date schema for this database can be found [here](https://github.com/JamesWheeler4/James_Portfolio/blob/main/Proj_5%20Track%20and%20Field%20Scouting/images/APDB_Schema_20220621.pdf). The code used to create and clear the database can be found [here](https://github.com/JamesWheeler4/James_Portfolio/blob/main/Proj_5%20Track%20and%20Field%20Scouting/python/APDB.py).

### **Web Scraping: Collection, Pre-Processing, and Storage**

1. The first step of collection was to identify and extract the relevant data. This was done by inspecting the data source and charting as short a path as possible to the desired information.
2. Initially the roadblock was having to log in to access any of the relevant data. For this I turned to Selenium. Using key inputs I was able to enter the website and navigate to the desired webpages.
3. Next was the issue of extracting the data in a sorted manner. All of the pertinent information is tagged as anchor links with limited differentiation. To work around this, I passed on using *bs4* and elected to extract the whole page, parse it as a string using regex.
4. Through this method I was able to iterate through parsed segments of the extracted source data. Along the way creating and replacing variables to store using SQLite3.
5. Using variations on the regex parsing method, I was able to gather a considerable set of data using the following functions:
  
[codeGather](https://github.com/JamesWheeler4/James_Portfolio/blob/main/Proj_5%20Track%20and%20Field%20Scouting/python/codeGather.py): This function takes state names as inputs and outputs the IDs required to visit all divisions, districts, and highschools from the given states via URL. 
  
[topGather](https://github.com/JamesWheeler4/James_Portfolio/blob/main/Proj_5%20Track%20and%20Field%20Scouting/python/topGather.py): Here the IDs collected with *codeGather* and a gender ID is input. The function outputs entries to the Athlete and Result table for the top ten marks for the given location ID. The supporting functions within *topGather* can be found [here](https://github.com/JamesWheeler4/James_Portfolio/blob/main/Proj_5%20Track%20and%20Field%20Scouting/python/topGatherSup.py).
  
[locationGather](https://github.com/JamesWheeler4/James_Portfolio/blob/main/Proj_5%20Track%20and%20Field%20Scouting/python/locationGather.py): To be more functional as a tool, this functions gathers location and contact information for the schools/clubs. This would in theory allow the scouting coach easy contact when evaluating the report.
  
[fullResultGather](https://github.com/JamesWheeler4/James_Portfolio/blob/main/Proj_5%20Track%20and%20Field%20Scouting/python/fullResultGather.py): For a more thorough exploration of past performance, this function was created to collect past marks for specific athletes. Currently it is set to collect the past marks (back to 2014) of the top 25 performing athletes in each athlete. This function collects the athlete's complete history, allowing for a comparative look at what events may have positive or negative correlations with performance.

### **Analysis**
1. Currently under way is an exploration of the *fullResultGather* data. Some questions that will be asked: What correlation is there between events for each given athlete? Ex. Which is more predictive of Long Jump performance, 100m results, 200m results, or neither? Do athletes out of specific states perform better within a given even area? Ex. Do distance runners in Oregon run faster that those in Nevada?
2. Exploring the correlation between any given event: 
- I explored a couple isolated cases (men's 100m(x) vs 200m(y)) by taking the average mark for each athlete in a given event, graphing each athlete as a single point, and calculating the correlation/adding a trend line. This was a promising approach so I wrote this [function](https://github.com/JamesWheeler4/James_Portfolio/blob/main/Proj_5%20Track%20and%20Field%20Scouting/python/graphCorData.py) to organize the calculated correlation coefficients (r values) into a heat map. One thing to notice in this data processing function is the use of event type comparison to more accurately represent correlation. When comparing the 100m dash (lower time is better) with the long jump (higher distance is better) to be high performing in both would produce a negative correlation. This wouldn't be an issue in isolation but when compared to the negative correlation seen between the 100m dash and 3200m run, it would appear that both of these cases, they would have similar relationships which is not true. To navigate this, I created a simple loop checking event type, inversing the r-value when a track event (100m) was compared to a field event(long jump). 
- Checking the csv against multiple externally calculated values in excel, I wrote two graphing functions for the [men](https://github.com/JamesWheeler4/James_Portfolio/blob/main/Proj_5%20Track%20and%20Field%20Scouting/python/graphMenCor.py) and [women](https://github.com/JamesWheeler4/James_Portfolio/blob/main/Proj_5%20Track%20and%20Field%20Scouting/python/graphWomenCor.py). 
- These output graphs representing the [men's correlations](https://github.com/JamesWheeler4/James_Portfolio/blob/main/Proj_5%20Track%20and%20Field%20Scouting/images/Men's%20Correlation%20Heatmap.png) and the [women's correlations](https://github.com/JamesWheeler4/James_Portfolio/blob/main/Proj_5%20Track%20and%20Field%20Scouting/images/Women's%20Correlation%20Heatmap.png). 
- Pleased with these I wanted to get a closer look at each event comparison. To do this I created this [function](https://github.com/JamesWheeler4/James_Portfolio/blob/main/Proj_5%20Track%20and%20Field%20Scouting/python/graphEventEvent.py) which compares one event to another. In addition to the overall correlation coefficient, I calculated the r-squared value and added the sample size of each comparison. To contribute more insight I faceted the trandling by each athlete's state. 
- These are some example of the graphs that were created, [W 800m vs. long jump](https://github.com/JamesWheeler4/James_Portfolio/blob/main/Proj_5%20Track%20and%20Field%20Scouting/images/Female's%20800m%20vs.%20lj.png), [W 100m vs. 200m](https://github.com/JamesWheeler4/James_Portfolio/blob/main/Proj_5%20Track%20and%20Field%20Scouting/images/Female's%20100m%20vs.%20200m.png), [M 400m vs. 800m](https://github.com/JamesWheeler4/James_Portfolio/blob/main/Proj_5%20Track%20and%20Field%20Scouting/images/Male's%20400m%20vs.%20800m.png), and [M high jump vs. triple jump](https://github.com/JamesWheeler4/James_Portfolio/blob/main/Proj_5%20Track%20and%20Field%20Scouting/images/Male's%20hj%20vs.%20tj.png). Unlike the heatmap earlier, you will notice the r-values when comparing track events to field events are not inversed in these graphs.
3. When looking over the correlation comparisons, some interesting trends appear:
- The women's heat map is less populated than the men's. This suggests a lack of event diversity in women's high school track and field in the PNW area. 
- Women's 100m vs. 200m has the highest r-value and 0.878 whereas the men's same value is 0.7686. The lowest is the men's javelin vs. 3000m at -0.7719 with the women not having enough participants to produce a value. When looking at the more edge cases, the polarity between a given even seems like chance. This can be seen when comparing men's javelin to the 1500m and 1600m. You would think that these values would be similar but they are -0.1102 and -0.4446 respectively. Another interesting point is the gendered difference when comparing long and triple jump to the sprints (100m, 200m, 400m). For the men, long jump vs. sprints values are nearly twice that of triple jump vs. sprints, with both jumps being the most correlated with 100m, then 200m, then 400m. This pattern is not seen in women. Instead the r-values for triple jump are closer to two thirds that of long jump when compared to 100m and 200m. This drastically falls off when comparing triple jump to 400m. 
- There are multiple examples between genders that, when looked at from a normative muscle development lense, show how technique can be out performed by strength within the mens events(shot put vs. high jump, hammer vs. javelin). This is the primary narrative that lead me believe that the women athletes are more specialized, focusing on technique development to compensate for the often slower strength growth. 
- Some important notes, the data used for these calculations was gathered from Oregon, Washington, Idaho, and Nevada. I pulled the top ten athletes in every district for every event from 2012 to June 2022. Then from each of these 106,883 athletes I took the top 100 from each event and pulled every recorded mark they had in their highschool career. This came to a total of 142,372 marks from 1907 athletes, averaging 74.65 marks per athlete with a max and min. of 339 and 2 marks per.  athlete. With a distribution of 68,393 women and 73979 men. 
- The limitation when calculating the correlation comparisons was that there had to be 10+ athletes in a given comparison in order to graph it.
- I plan on revisiting with exploration again once gathering more past marks from athletes. It is my understanding that some of the insight gained, particularly on the women's side, can be attributed to only taking the top 100 athletes for each event.

4. Here are examples of [SQL queries](https://github.com/JamesWheeler4/James_Portfolio/blob/main/Proj_5%20Track%20and%20Field%20Scouting/python/futureQueries.py) that I have been running on the dataset for future exploration.
